# 서블릿

## ✅ 서블릿이란❓

---

> 자바 언어로 작성된 **서버 측 프로그램**이다.
>
- 웹 요청을 처리하고, 동적 웹 콘텐츠를 생성하기 위해 사용된다.

→ 쉽게 말해서, 요청이 들어왔을 때 요청을 처리해주는 자바 기반의 웹 어플리케이션 프로그래밍 기술이다.

## ✅ 클라이언트 요청 처리 프로세스

---

### 1️⃣ 웹 서버가 요청을 처리 수신

- 클라이언트가 HTTP 요청을 보내면, 웹 서버 (Apache, Nginx 등)가 가장 먼저 이 요청을 받는다.
- 웹 서버는 정적 파일을 처리할 수도 있지만, 동적 처리가 필요한 경우 **WAS에 요청을 전달**하는 역할도 수행한다❗

### 2️⃣ WAS에 요청 전달

- 웹 서버는 이 요청이 동적 요청임을 인식하고, WAS로 전달한다.
- WAS는 **서블릿 컨테이너**를 포함하고 있어, 서블릿과 같은 동적 웹 애플리케이션을 실행할 수 있다.

### 3️⃣ 서블릿 컨테이너에서 서블릿 매핑

- WAS 내부의 서블릿 컨테이너는 요청 URL을 분석하여, 해당 URL 패턴에 매핑된 서블릿을 찾는다.
- 매핑된 서블릿이 없다면 404 에러를 반환하고, 서블릿이 있으면 해당 서블릿의 `service()` 메서드를 호출하여 요청을 처리한다.

### 4️⃣ 서블릿이 요청 처리

- 서블릿은 service(), doGet(), doPost() 등의 메서드를 통해 요청을 처리한다.
- 필요한 로직을 실행하고, 동적 컨텐츠를 생성하여 응답을 생성한다.

### 5️⃣ 응답 반환

- 서블릿이 생성한 응답은 서블릿 컨테이너를 통해  WAS로 전달되고, 다시 웹 서버로 전달된다.
- 마지막으로 웹 서버는 이 응답을 클라이언트에게 반환하여 브라우저에 표시된다.

## ✅ 스프링과 서블릿의 관계

---

> Spring은 Java로 작성된 서블릿 기반의 웹 애플리케이션 프레임워크로, 서블릿의 한계와 중복을 줄이기 위해 **보다 효율적이고 간결한 웹 개발을 돕는 구조와 기능을 제공한다.**
>

### ✔️ 스프링 MVC와 서블릿

- **DispatcherServlet**

  Spring MVC는 모든 HTTP 요청이 **`DispatcherServlet`**이라는 서블릿을 통해 관리된다. **`DispatcherServlet`**은 서블릿 컨테이너의 서블릿으로 등록되어, 모든 요청을 받아 컨트롤러, 서비스, 모델 등 애플리케이션의 다른 구성요소에 분배한다.

- **핸들러 매핑과 뷰 해석**: **`DispatcherServlet`**은 컨트롤러를 찾아서 요청을 전달하고, 그 결과를 받아 최종 응답을 생성하여 클라이언트로 보낸다. 이런 작업은 서블릿을 사용하는 전통적인 방식보다 효율적이다.

### ✔️ 스프링부트와 서블릿 컨테이너

- 스프링 부트는 **내장형 컨테이너(Tomcat)**를 지원하여 별도의 설정 없이 웹 서버를 실행할 수 있다. 내장 서블릿 컨테이너를 통해 서블릿 기반 애플리케이션을 자동으로 관리하며, `@SpringBootApplication`을 통해 서버를 시작하고 HTTP 요청을 처리할 준비가 된다.

## ✅ Spring Boot에서 클라이언트 요청 처리 프로세스❗

### 1️⃣ **클라이언트 요청 수신 (내장 웹 서버)**

- 클라이언트(브라우저 또는 다른 HTTP 클라이언트)가 요청을 보내면, Spring Boot 애플리케이션의 **내장 WAS**(주로 Tomcat, Jetty 등)가 이 요청을 가장 먼저 수신합니다.
- Spring Boot는 웹 서버를 애플리케이션 내부에 포함하고 있어, 별도로 외부 서버를 설정할 필요 없이 애플리케이션 실행만으로 HTTP 요청을 받을 수 있습니다.

### 2️⃣ **DispatcherServlet으로 요청 전달**

- 내장 WAS는 요청을 분석하여, **Spring MVC의 DispatcherServlet**으로 요청을 전달합니다.
- Spring Boot는 `@SpringBootApplication` 애노테이션을 통해 `DispatcherServlet`을 자동으로 설정해두므로, 개발자가 수동으로 등록할 필요가 없습니다.

### 3️⃣ **Handler Mapping을 통해 컨트롤러 메서드 매핑**

- `DispatcherServlet`은 요청 URI를 기반으로, 적절한 **Handler Mapping**을 찾아 요청을 특정 컨트롤러 메서드로 매핑합니다.
- Spring Boot에서는 `@Controller` 또는 `@RestController`와 `@RequestMapping`을 사용하여 **매핑을 설정**하며, 각 경로(URL)에 맞는 컨트롤러 메서드가 호출되도록 합니다.

### 4️⃣ **컨트롤러에서 요청 처리**

- 매핑된 컨트롤러 메서드는 `@RequestParam`, `@PathVariable`, `@RequestBody` 등을 사용해 클라이언트의 요청 데이터를 받아 처리하고, 필요한 작업을 수행합니다.
- 컨트롤러에서 비즈니스 로직이 필요할 경우, **서비스 계층**을 호출하여 로직을 처리하고, 그 결과를 응답으로 생성합니다.

### 5️⃣ **응답 반환 및 뷰 렌더링 (선택 사항)**

- 컨트롤러 메서드에서 처리된 응답은 `DispatcherServlet`을 통해 클라이언트에게 전달됩니다.
- 일반적으로 `@RestController`를 사용하면 JSON 형태의 응답이 바로 반환되고, `@Controller`를 사용해 JSP 또는 Thymeleaf 템플릿을 이용할 경우, 뷰 리졸버가 HTML을 렌더링해 반환합니다.

### 6️⃣ **클라이언트에 응답 전송**

- 최종적으로 WAS가 이 응답을 클라이언트로 전송하고, 클라이언트는 요청에 대한 결과를 화면에 표시하거나 필요한 후속 작업을 진행합니다.